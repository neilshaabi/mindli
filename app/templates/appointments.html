{% extends 'layout.html' %}

{% block title %}
    Appointments
{% endblock %}

{% block content %}

    <div class='container'>
        
        <div class='row mb-3 g-4'>
            <div class='col-lg-12'>
                <h3>Appointments</h3>
            </div>
        </div>
        
        <div class="row g-4 mb-4">
            <div class='col-lg-12'>
                <div class='my-card'>
                    
                    <h3>Filter Appointments</h3>

                </div>
            </div>
        </div>

        <div class="row g-4 mb-4">
            <div class='col-lg-12'>
                <div class='my-card'>
                    <h3>My Appointments</h3>
                    {% if not appointments %}
                        <p class="text-muted">
                            No appointments found. Please visit the <a href="/therapists">therapist directory</a> to find a professional from our community best suited to your needs.
                        </p>
                    {% else %}
                        <table class="table text-center">
                            <thead>
                                <tr>
                                    <th>Date and Time</th>
                                    <th>
                                        {% if current_user.role == UserRole.THERAPIST %}
                                            Client
                                        {% elif current_user.role == UserRole.CLIENT %}
                                            Therapist
                                        {% endif %}
                                    </th>
                                    <th>Type</th>
                                    <th>Mode</th>
                                    <th>Duration</th>
                                    <th>Status</th>
                                    <th>Payment</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for appointment in appointments %}
                                    <tr>
                                        <td>{{ appointment.time.strftime('%d %b %Y - %H:%M') }}</td>
                                        <td>{{ appointment.other_user.full_name }}</td>
                                        <td>{{ tag(label=appointment.appointment_type.therapy_type.value, status=appointment.appointment_type.therapy_type.name, with_icon=False) }}</td>
                                        <td>{{ tag(label=appointment.appointment_type.therapy_mode.value, status=appointment.appointment_type.therapy_mode.name, with_icon=False) }}</td>
                                        <td>{{ appointment.appointment_type.duration }} minutes</td>
                                        <td>{{ tag(label=appointment.appointment_status.value, status=appointment.appointment_status.name, with_icon=False) }}</td>
                                        <td>{{ tag(label=appointment.payment_status.value, status=appointment.payment_status.name, with_icon=False) }}</td>
                                        <td>
                                            <div class="btn-container">
                                                <a href="{{ url_for('appointments.appointment', appointment_id=appointment.id) }}" class="btn btn-icon"
                                                    data-bs-toggle="tooltip" data-bs-placement="left" data-bs-custom-class="my-tooltip" data-bs-title="View details">
                                                    <i class="fa-solid fa-ellipsis"></i>
                                                </button>
                                            </div>
                                        </td>        
                                {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                </div>
            </div>
        </div>

    </div>

{% endblock %}
